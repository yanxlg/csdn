---
title: client & server timeAsync
date: 2019-09-29 17:55:21
tags:
---
 时间同步问题在客户端比较常见，通常很多的网站或者m站中都将时间转换成服务端时间，即实时调用接口，让服务端去进行请求队列处理，因为客户端时间不准确，而在某些同步场景下对于服务端的资源消耗会非常严重，并发级别很高，很多场景如果想要做并发优化，就无法实时记录每次事件的触发时间，因此客户端与服务端时间同步在一定程度上会非常棘手。本文介绍比较实用的同步方法，并介绍相关使用场景
 
## 同步方式：
   1. 页面初始化时，通过api接口response对象header中获取服务端时间并记录当前客户端时间，通过毫秒方式保存两个时间
   2. 在发生操作，需要获取服务端时间时，通过当前客户端时间与上面保存的客户端时间做计算，再加上上面保存的服务端时间，得出当前服务器时间
   3. 在所有接口中进行服务端时间的同步，确保时间误差不会太大
   4. 在App从后台切回前台时，调用时间同步接口进行一次时间同步，在浏览器从后台切回前台时同样进行一次同步，具体的浏览器判断方式可以查阅相关资料，有一些不是很成熟的方式可以参考

## 使用场景
   1. 对于时间精确度要求不是特别严格的场景，因此此方案多少会存在于服务器的误差
   2. 非实时需要上传的数据
   3. 本地日志上报、埋点等缓存本地，定时上报，而非实时上报
   
