---
title: node 自动切换
categories:
  - node
tags:
  - node
abbrlink: fbeb4634
---
## 问题背景
很多场景下我们需要同时使用多个不同版本的Node.js。比如：你有多个项目，这些项目由于开始时间不同，用的Node.js版本都会不同；又或者你现在项目用的是4.x.x，但是你想试试下一个LTS版本——6.x.x。这些情况下，你会发现你每次都要去切换Node.js的版本，哪怕你用NVM来管理多个Node.js，切换也都需要执行nvm use ...命令。有的时候会忘记导致很多不必要的麻烦！

那么怎么样才能根据不同的项目自动切换对应的Node版本呢？

## 思路
先抛开是否有工具可以帮我们完成这件事情。我们先来想一下如果让你来实现这样一个功能，你会怎么做？

首先，你至少需要申明你各个项目所需要的Node版本号，那么最方便的就是：

1. 直接申明在 package.json 中
2. 单独在项目根目录中某个文件中（文件名约定好）申明

然后，我们需要一个触发点，这个触发点可以让你去根据上述提到的文件中获取到 Node 版本号并自动切换。而这个切换点最好的当然是cd命令。因为我们总是需要先cd到项目目录中去。

好了，以上就是我们的思路，汇总下来就是：

1. 在项目根目录中需要一个地方来申明需要的 Node 版本号
2. 当用户“进入”到项目中的时候，自动根据申明的 Node 版本号进行自动切换

##解决方案
社区已经有类似我们上述思路的工具，这里推荐[avn-Automatic Version Switching for Node](https://github.com/wbyoung/avn )，avn 提供了 nvm的插件（当然也有n的插件），使用起来非常简单（以NVM为例），直接：

```shell
npm i -g avn avn-nvm
avn setup
```

然后呢，只要在你的项目根目录下创建一个`.node-version`文件，并且以[semver](https://semver.org/ )的格式来申明所需要的 Node 的版本号，如：4.5.0

接着，当你cd到项目目录中的时候，avn 就会自动帮你切换到指定的 Node 版本。非常方便！
